name: Continuous Integration and Deployment

on: 
    push:
        branches: 
            - main

env: 
    DOTNET-VERSION: '7.0.x'
    
jobs: 
    build:
        runs-on: ubuntu-latest
        steps: 
            - name: Check out code ðŸ›Ž
              uses: actions/checkout@v3

            - name: Setpu .NET 
              uses: actions/setup-dotnet@v3
              with:
                dotnet-version: ${{ env.DOTNET-VERSION }}

            - name: Restore dependencies ðŸ› 
              run: dotnet restore
              working-directory: WeatherForeCastAPI

            - name: Build App ðŸš€
              run: dotnet build -c Release --no-restore
              working-directory: WeatherForeCastAPI

            - name: Run automatted tests ðŸ§ª
              run: dotnet test
              working-directory: WeatherForeCast.Test

            - name: Publish app
              run: dotnet publish -c Release -o ./out
              working-directory: WeatherForeCastAPI
